# SIPp Load Testing Tool

Этот проект предоставляет Docker-контейнер для запуска SIPp (SIP Performance Testing Tool) в качестве клиента (UAC) для тестирования SIP-сервера. Контейнер включает в себя сценарий для имитации SIP-вызовов и скрипт для их управления.

## Файлы проекта

*   `Dockerfile`: Содержит инструкции для сборки Docker-образа с установленным SIPp и необходимыми зависимостями.
*   `scenario.xml`: Сценарий для SIPp, который описывает поведение клиента (UAC).
*   `run_calls.sh`: Скрипт для запуска SIPp с заданными параметрами (и случайной генерацией продолжительности разговора в заданных пределах), такими как количество вызовов, интервал между вызовами.

## Параметры запуска

Скрипт `run_calls.sh` поддерживает следующие переменные окружения для настройки тестов:

| Параметр      | Описание                                 | Значение по умолчанию |
|---------------|------------------------------------------|-----------------------|
| `REMOTE_IP`   | IP-адрес удалённого SIP-сервера          | нет         |
| `REMOTE_PORT` | Порт удалённого SIP-сервера              | `5060`                |
| `LOCAL_IP`    | IP-адрес клиента                         | нет         |
| `LOCAL_PORT`  | Порт клиента                             | `5060`                |
| `CALL_COUNT`  | Количество вызовов                       | `30`                  |
| `CALL_INTERVAL`| Интервал между вызовами (в секундах)   | `30`                  |
| `MIN_DURATION`| Минимальная длительность вызова (в минутах)| `2`                   |
| `MAX_DURATION`| Максимальная длительность вызова (в минутах)| `6`                   |

Перед запуском скрипт проверяет передачу переменных REMOTE_IP и LOCAL_IP. При отсутствии какой-либо из них будет выдана соответствующая ошибка.

## Сборка Docker-образа

Для сборки Docker-образа выполните следующую команду в корневой директории проекта:

```
docker build -t sipp-load-test .
```

## Запуск контейнера
После сборки образа контейнера запустите его, указав требуемые значения параметров.
### Пример запуска
```
docker run \
  --network host \
  -e REMOTE_IP=10.0.0.1 \
  -e REMOTE_PORT=5060 \
  -e LOCAL_IP=$(hostname -I | awk '{print $1}') \
  -e LOCAL_PORT=5060 \
  -e CALL_COUNT=50 \
  -e CALL_INTERVAL=10 \
  -e MIN_DURATION=1 \
  -e MAX_DURATION=5 \
  sipp-load-test
```
Для каждого из параметров укажите нужное для вас значение.

## Логирование
Если вам нужно сохранить логи, вы можете перенаправить вывод в файл:
```
docker run sipp-load-test > sipp_test_logs.txt
```
